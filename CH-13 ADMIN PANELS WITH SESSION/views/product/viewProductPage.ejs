<%- include('../header') %>

    <div class="container-fluid pt-4 px-4">
        <div class="row g-4">
            <div class="col-sm-12">
                <div class="bg-secondary rounded h-100 p-4">
                    <h6 class="mb-4">Products</h6>
                    <div class="table-responsive">
                        <table class="table table-hover text-center">
                            <thead class="text-center">
                                <tr>
                                    <th>No</th>
                                    <th>Product Name</th>
                                    <th>Category Name</th>
                                    <th>Sub Category Name</th>
                                    <th>Extra Category Name</th>
                                    <th>Old Price</th>
                                    <th>New Price</th>
                                    <th>Stock</th>
                                    <th>Product Image</th>
                                    <th>Description</th>
                                    <th colspan="2">Action</th>
                                </tr>
                            </thead>
                            <tbody class="text-center">
                                <% allProduct.forEach((data, index)=> { %>
                                    <tr>
                                        <td>
                                            <%= index + 1 %>
                                        </td>
                                        <td>
                                            <%= data.product_name %>
                                        </td>
                                        <td>
                                            <%= data.category_id.category_name %>
                                        </td>
                                        <td>
                                            <%= data.subcategory_id.subcategory_name %>
                                        </td>
                                        <td>
                                            <%= data.extra_category_id.extra_category_name %>
                                        </td>
                                        <td>
                                            <%= data.old_price %>
                                        </td>
                                        <td>
                                            <%= data.price %>
                                        </td>
                                        <td>
                                            <%= data.stock %>
                                        </td>
                                        <td>
                                            <img src="../<%= data.image %>" width="50px" height="50px" />
                                        </td>
                                        <td>
                                            <div id="desc-container-<%= data._id %>"
                                                style="max-width: 200px; margin: 0 auto; text-align: left;">
                                                <span id="short-<%= data._id %>">
                                                    <%= data.description.substring(0, 50) %>...
                                                </span>

                                                <span id="full-<%= data._id %>" style="display: none;">
                                                    <%= data.description %>
                                                </span>

                                                <br>
                                                <button class="btn btn-sm btn-info mt-1"
                                                    onclick="toggleDescription('<%= data._id %>')"
                                                    id="btn-<%= data._id %>">
                                                    More
                                                </button>
                                            </div>
                                        </td>
                                        <td>
                                            <button class="btn btn-danger">
                                                <a href="/product/deleteProduct?Id=<%= data._id %>"
                                                    style="color: white; text-decoration: none;">Delete</a>
                                            </button>
                                        </td>
                                        <td>
                                            <button class="btn btn-warning">
                                                <a href="/product/editProductPage/<%= data._id %>"
                                                    style="color: white; text-decoration: none;">Edit</a>
                                            </button>
                                        </td>
                                    </tr>
                                    <% }) %>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <%- include('../footer') %>

        <script>
            function toggleDescription(productId) {
                const shortDesc = document.getElementById(`short-${productId}`);
                const fullDesc = document.getElementById(`full-${productId}`);
                const btn = document.getElementById(`btn-${productId}`);

                if (fullDesc.style.display === 'none') {
                    // Jab 'More' dabaye: Short text ko chupa do aur Full text dikhao
                    shortDesc.style.display = 'none';
                    fullDesc.style.display = 'inline';
                    btn.textContent = 'Less';
                    btn.classList.replace('btn-info', 'btn-secondary');
                } else {
                    // Jab 'Less' dabaye: Full text ko chupa do aur Short text wapas dikhao
                    shortDesc.style.display = 'inline';
                    fullDesc.style.display = 'none';
                    btn.textContent = 'More';
                    btn.classList.replace('btn-secondary', 'btn-info');
                }
            }
        </script>